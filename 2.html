<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…§åˆ†æ³Œè…ºèˆ‡æ¿€ç´  - äº’å‹•å­¸ç¿’å–®</title>
    <style>
        /* --- åŸºç¤æ¨£å¼ --- */
        :root {
            --primary-color: #2c3e50;
            --accent-color: #e67e22;
            --highlight-1: #c0392b;
            --highlight-2: #2980b9;
            --success-bg: #d4edda;
            --success-border: #c3e6cb;
            --success-text: #155724;
            --error-bg: #f8d7da;
            --error-border: #f5c6cb;
            --error-text: #721c24;
        }

        body {
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
            line-height: 1.8;
            color: #333;
            background-color: #f9f9f9;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: #fff;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            border-bottom: 3px solid var(--accent-color);
            padding-bottom: 15px;
            margin-bottom: 30px;
        }

        h2 {
            color: var(--primary-color);
            border-left: 5px solid var(--accent-color);
            padding-left: 10px;
            margin-top: 40px;
        }

        p {
            font-size: 1.1em;
            text-align: justify;
        }

        .kw-1 {
            color: var(--highlight-1);
            font-weight: bold;
            background-color: rgba(192, 57, 43, 0.1);
            padding: 0 4px;
            border-radius: 4px;
        }

        .kw-2 {
            color: var(--highlight-2);
            font-weight: bold;
            background-color: rgba(41, 128, 185, 0.1);
            padding: 0 4px;
            border-radius: 4px;
        }

        .img-container {
            width: 100%;
            text-align: center;
            margin: 25px 0;
        }

        .img-container img {
            width: 66.66%;
            height: auto;
            border-radius: 8px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        /* --- åŸæœ¬ Q3 çš„æ¨£å¼ --- */
        .quiz-section { margin-top: 50px; border-top: 2px dashed #ccc; padding-top: 20px; }
        .quiz-card { background: #fdfdfd; border: 1px solid #eee; border-radius: 8px; padding: 20px; margin-bottom: 20px; transition: all 0.3s; }
        .quiz-card h3 { margin-top: 0; font-size: 1.2em; }
        .options label { display: block; margin: 10px 0; cursor: pointer; padding: 10px; background: #f0f0f0; border-radius: 5px; transition: background 0.2s; }
        .options label:hover { background: #e0e0e0; }
        .options input { margin-right: 10px; }
        select { padding: 8px; border-radius: 5px; border: 1px solid #ccc; }
        
        .drag-area { display: flex; gap: 20px; margin-top: 20px; flex-wrap: wrap; }
        .source-box { width: 100%; min-height: 80px; padding: 15px; background-color: #ecf0f1; border: 2px dashed #bdc3c7; border-radius: 8px; display: flex; flex-wrap: wrap; gap: 10px; align-items: center; justify-content: center; }
        .drop-zones-container { display: flex; width: 100%; gap: 20px; }
        .drop-zone { flex: 1; min-height: 200px; background-color: #f8f9fa; border: 2px solid #34495e; border-radius: 8px; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        .drop-zone h4 { margin: 0 0 10px 0; color: #2c3e50; text-align: center; padding-bottom: 5px; border-bottom: 1px solid #ddd; width: 100%; }
        
        .draggable-item { background-color: #fff; border: 1px solid #ccc; padding: 8px 15px; border-radius: 20px; cursor: grab; font-weight: bold; box-shadow: 0 2px 4px rgba(0,0,0,0.1); user-select: none; transition: transform 0.2s; }
        .draggable-item:hover { background-color: var(--accent-color); color: white; border-color: var(--accent-color); }
        .draggable-item:active { cursor: grabbing; }
        .drop-zone.over { background-color: #e8f6f3; border-color: #1abc9c; transform: scale(1.02); }

        .feedback { display: none; margin-top: 15px; padding: 15px; border-radius: 5px; font-weight: bold; }
        .quiz-card.correct { border: 2px solid var(--success-border); background-color: #f0fff4; }
        .quiz-card.correct .feedback { display: block; background-color: var(--success-bg); color: var(--success-text); border: 1px solid var(--success-border); }
        .quiz-card.incorrect { border: 2px solid var(--error-border); background-color: #fff5f5; }
        .quiz-card.incorrect .feedback { display: block; background-color: var(--error-bg); color: var(--error-text); border: 1px solid var(--error-border); }

        .btn { display: inline-block; padding: 10px 20px; margin-top: 10px; border: none; border-radius: 5px; cursor: pointer; font-size: 1em; transition: background 0.3s; }
        .btn-check { background-color: var(--primary-color); color: white; }
        .btn-check:disabled { background-color: #ccc; cursor: not-allowed; }
        .btn-check:hover:not(:disabled) { background-color: #34495e; }
        .btn-retry { display: none; background-color: var(--accent-color); color: white; }
        .btn-retry:hover { background-color: #d35400; }

        .nav-bar { display: flex; justify-content: space-between; margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; }
        .nav-link { text-decoration: none; padding: 12px 25px; border-radius: 30px; font-weight: bold; color: white; background-color: var(--primary-color); transition: all 0.3s; }
        .nav-link.disabled { pointer-events: none; background-color: #ccc; cursor: default; }
        .nav-link:hover:not(.disabled) { background-color: var(--accent-color); transform: translateY(-2px); }
        
        @media (max-width: 600px) { .drop-zones-container { flex-direction: column; } }

        /* --- äº’å‹•äººé«”åœ–æ¨£å¼ --- */
        .map-wrapper {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }

        .interactive-map-container {
            position: relative;
            display: inline-block;
            max-width: 80%;
            min-width: 300px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            border-radius: 10px;
            line-height: 0;
            -webkit-user-select: none;
            user-select: none;
        }

        .interactive-map-container img {
            display: block;
            width: 100%;
            height: auto;
            pointer-events: none;
        }

        .hotspot {
            position: absolute;
            width: 6%; height: 7%;
            border-radius: 50%;
            cursor: pointer;
            z-index: 10;
            background-color: rgba(255, 235, 59, 0.5); 
            border: 2px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 0 5px rgba(0,0,0,0.3);
            transition: transform 0.2s, background-color 0.2s;
            -webkit-tap-highlight-color: transparent;
        }

        .hotspot:hover {
            background-color: rgba(255, 235, 59, 0.8);
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 235, 59, 1);
            border-color: #fff;
        }

        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.98);
            border-left: 6px solid #009688;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.4);
            width: 260px;
            display: none;
            z-index: 9999;
            pointer-events: none;
            font-size: 1rem;
            line-height: 1.5;
            text-align: justify;
        }
        .tooltip h3 { margin: 0 0 8px 0; color: #009688; border-bottom: 1px solid #eee; padding-bottom: 5px; font-size: 1.1rem; }
        .tooltip p { margin: 0; color: #333; }

        /* --- å¡«ç©ºæ¸¬é©—éŠæˆ²æ¨£å¼ --- */
        .test-game-wrapper {
            display: flex;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e0e0e0;
            width: 100%;
            gap: 20px;
            align-items: flex-start;
            flex-direction: row;
            box-sizing: border-box;
            margin-top: 30px;
        }

        .test-options-panel {
            width: 180px;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            gap: 8px;
            background: #fff;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ddd;
        }

        .test-options-header {
            color: #0033cc;
            font-weight: bold;
            text-align: center;
            border-bottom: 2px solid #0033cc;
            padding-bottom: 5px;
            margin-bottom: 5px;
        }

        .test-draggable-item {
            background-color: #fff;
            color: #cc0000; 
            font-weight: bold;
            font-size: 15px;
            padding: 8px 4px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 6px;
            cursor: grab;
            user-select: none;
            touch-action: none; 
            box-shadow: 2px 2px 5px rgba(0,0,0,0.05);
            transition: transform 0.1s;
        }

        .test-draggable-item.dragging { opacity: 0.4; border: 2px dashed #999; background-color: #eee; }
        .test-draggable-item.touch-drag { position: fixed; z-index: 9999; opacity: 0.9; background-color: #ffe082; box-shadow: 0 10px 20px rgba(0,0,0,0.2); pointer-events: none; width: 150px; transform: scale(1.1); }
        .test-draggable-item.matched { display: none; }

        .test-game-board {
            position: relative;
            width: 100%;
            font-size: 0; /* é€™è£¡åŸæœ¬å°è‡´æ–‡å­—æ¶ˆå¤± */
        }

        .test-base-image {
            width: 100%;
            height: auto;
            display: block;
            border-radius: 8px;
            pointer-events: none;
        }

        .test-drop-zone {
            position: absolute;
            width: 20.5%; 
            height: 7.2%; 
            background-color: #ffffff; 
            border: 2px solid #333;    
            box-shadow: 2px 2px 4px rgba(0,0,0,0.1); 
            border-radius: 4px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: clamp(10px, 1.2vw, 18px); 
            font-weight: bold;
            color: transparent; 
            z-index: 10;
            box-sizing: border-box; 
            transition: background-color 0.2s, border-color 0.2s;
        }

        .test-drop-zone.drag-over { background-color: #fff9c4; border: 2px dashed #fbc02d; transform: scale(1.02); }
        .test-drop-zone.correct { background-color: #ffffff; color: #cc0000; border: 2px solid #4caf50; box-shadow: 0 0 8px rgba(76, 175, 80, 0.4); overflow: hidden; white-space: nowrap; }

        #zone-gland-pituitary { top: 9.8%; left: 52%; }
        #zone-hormone-pituitary { top: 9.8%; left: 77.2%; }
        #zone-gland-thyroid { top: 22.2%; left: 52%; }
        #zone-hormone-thyroid { top: 22.2%; left: 77.2%; }
        #zone-gland-parathyroid { top: 52.5%; left: 52%; }
        #zone-hormone-parathyroid { top: 52.5%; left: 77.2%; }
        #zone-gland-adrenal { top: 64.8%; left: 52%; }
        #zone-hormone-adrenal { top: 64.8%; left: 77.2%; }
        #zone-gland-pancreas { top: 77.2%; left: 52%; }
        #zone-hormone-pancreas { top: 77.2%; left: 77.2%; }
        #zone-gland-gonad { top: 89.5%; left: 52%; }
        #zone-hormone-gonad { top: 89.5%; left: 77.2%; }

        @media (max-width: 800px) {
            .test-game-wrapper { flex-direction: column; align-items: center; }
            .test-options-panel { width: 100%; flex-direction: row; flex-wrap: wrap; justify-content: center; }
            .test-draggable-item { font-size: 14px; padding: 6px 10px; flex-grow: 1; }
        }
        
        /* ä¿®æ­£ï¼šå¼·åˆ¶è¨­å®šæˆåŠŸè¦–çª—çš„å­—é«”å¤§å°ï¼Œé¿å…è¢«å¤–å±¤çš„ font-size:0 å½±éŸ¿ */
        #test-success-overlay {
            font-size: 16px; 
            line-height: 1.5;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>å…§åˆ†æ³Œè…ºèˆ‡æ¿€ç´ </h1>

    <section>
        <h2>å…§åˆ†æ³Œè…ºèˆ‡æ¿€ç´ </h2>
        <p>
            äººé«”çš„å…§åˆ†æ³Œç³»çµ±ç”±å¤šç¨®<span class="kw-1">å…§åˆ†æ³Œè…º</span>çµ„æˆã€‚å…§åˆ†æ³Œè…ºæœƒåˆ†æ³Œ<span class="kw-1">æ¿€ç´ </span>ï¼ˆåˆç¨±è·çˆ¾è’™ï¼‰ï¼Œæ¿€ç´ éš¨<span class="kw-2">è¡€æ¶²</span>é‹é€åˆ°ä½œç”¨éƒ¨ä½ï¼Œèª¿ç¯€ã€æ§åˆ¶ç´°èƒæ´»å‹•ï¼Œé€²è€Œå½±éŸ¿å€‹é«”ç”Ÿé•·åŠç¶­æŒé«”å…§ç’°å¢ƒç©©å®šã€‚<span class="kw-2">è¡€æ¶²</span>ä¸­åªéœ€è¦<span class="kw-1">é©é‡</span>æ¿€ç´ ï¼Œå°±èƒ½å°ç”Ÿç†åŠŸèƒ½ç”¢ç”Ÿæ˜é¡¯çš„å½±éŸ¿ã€‚æ¿€ç´ çš„åˆ†æ³Œé‡èˆ‡åˆ†æ³Œæ™‚æ©Ÿå¿…é ˆé©ç•¶ï¼Œåˆ†æ³Œéå¤šæˆ–éå°‘ã€éæ—©æˆ–éæ™šéƒ½å°å€‹é«”æœ‰ä¸åˆ©çš„å½±éŸ¿ã€‚
        </p>
        
        <div class="map-wrapper">
            <p class="instruction" style="margin-bottom: 5px; font-size: 0.9em; color:#666;">ï¼ˆè«‹å°‡æ»‘é¼ ç§»å‹•åˆ°åœ–ç‰‡ä¸Šçš„<b>é»ƒè‰²äº®é»</b>æŸ¥çœ‹åŠŸèƒ½ï¼‰</p>
            <div class="interactive-map-container" id="map-container">
                <img src="2_3.png" alt="äººé«”å…§åˆ†æ³Œç³»çµ±ç¤ºæ„åœ–">
                <div class="hotspot" style="top: 15%; left: 62.5%;" data-id="1"></div>
                <div class="hotspot" style="top: 28.5%; left: 62.5%;" data-id="2"></div>
                <div class="hotspot" style="top: 33.5%; left: 17.5%;" data-id="3"></div>
                <div class="hotspot" style="top: 46%; left: 62.5%;" data-id="4"></div>
                <div class="hotspot" style="top: 59.5%; left: 62.5%;" data-id="5"></div>
                <div class="hotspot" style="top: 73%; left: 62.5%;" data-id="6"></div>
                <div class="hotspot" style="top: 86%; left: 62.5%;" data-id="6"></div>
            </div>
            <div class="tooltip" id="tooltip"></div>
        </div>

        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 40px; border-bottom: 2px dashed #0033cc; padding-bottom: 10px;">
            <h3 style="margin: 0; color: #0033cc;">è‡ªæˆ‘æŒ‘æˆ°ï¼šå…§åˆ†æ³Œå¡«å¡«çœ‹</h3>
            <button onclick="resetGame()" style="background-color: #6c757d; color: white; border: none; padding: 5px 15px; border-radius: 5px; cursor: pointer; font-size: 0.9em;">
                â†º é‡ç½®éŠæˆ²
            </button>
        </div>
        <p>è«‹å°‡å·¦å´çš„æ¨™ç±¤æ‹–æ›³è‡³åœ–ä¸­æ­£ç¢ºçš„ç©ºæ ¼ä¸­ã€‚</p>
        
        <div class="test-game-wrapper">
            <div class="test-options-panel" id="test-options-container">
                <div class="test-options-header">é¸é …æ¸…å–®</div>
                <div class="test-draggable-item" data-type="gland" data-id="pituitary">è…¦å‚è…º</div>
                <div class="test-draggable-item" data-type="gland" data-id="thyroid">ç”²ç‹€è…º</div>
                <div class="test-draggable-item" data-type="gland" data-id="parathyroid">å‰¯ç”²ç‹€è…º</div>
                <div class="test-draggable-item" data-type="gland" data-id="adrenal">è…ä¸Šè…º</div>
                <div class="test-draggable-item" data-type="gland" data-id="pancreas">èƒ°å³¶</div>
                <div class="test-draggable-item" data-type="gland" data-id="gonad">æ€§è…º</div>
            
                <div class="test-draggable-item" data-type="hormone" data-id="pituitary">ç”Ÿé•·æ¿€ç´ </div>
                <div class="test-draggable-item" data-type="hormone" data-id="thyroid">ç”²ç‹€è…ºç´ </div>
                <div class="test-draggable-item" data-type="hormone" data-id="parathyroid">å‰¯ç”²ç‹€è…ºç´ </div>
                <div class="test-draggable-item" data-type="hormone" data-id="adrenal">è…ä¸Šè…ºç´ </div>
                <div class="test-draggable-item" data-type="hormone" data-id="pancreas">èƒ°å³¶ç´ .å‡ç³–ç´ </div>
                <div class="test-draggable-item" data-type="hormone" data-id="gonad">é›Œé›„æ€§æ¿€ç´ </div>
            </div>
            
            <div class="test-game-board">
                <img src="test.png" alt="å…§åˆ†æ³Œç³»çµ±åº•åœ–" class="test-base-image">
            
                <div class="test-drop-zone" id="zone-gland-pituitary" data-type="gland" data-id="pituitary"></div>
                <div class="test-drop-zone" id="zone-gland-thyroid" data-type="gland" data-id="thyroid"></div>
                <div class="test-drop-zone" id="zone-gland-parathyroid" data-type="gland" data-id="parathyroid"></div>
                <div class="test-drop-zone" id="zone-gland-adrenal" data-type="gland" data-id="adrenal"></div>
                <div class="test-drop-zone" id="zone-gland-pancreas" data-type="gland" data-id="pancreas"></div>
                <div class="test-drop-zone" id="zone-gland-gonad" data-type="gland" data-id="gonad"></div>
            
                <div class="test-drop-zone" id="zone-hormone-pituitary" data-type="hormone" data-id="pituitary"></div>
                <div class="test-drop-zone" id="zone-hormone-thyroid" data-type="hormone" data-id="thyroid"></div>
                <div class="test-drop-zone" id="zone-hormone-parathyroid" data-type="hormone" data-id="parathyroid"></div>
                <div class="test-drop-zone" id="zone-hormone-adrenal" data-type="hormone" data-id="adrenal"></div>
                <div class="test-drop-zone" id="zone-hormone-pancreas" data-type="hormone" data-id="pancreas"></div>
                <div class="test-drop-zone" id="zone-hormone-gonad" data-type="hormone" data-id="gonad"></div>
            
                <div id="test-success-overlay" style="display: none; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.95); z-index: 100; flex-direction: column; justify-content: center; align-items: center; border-radius: 8px;">
                    <h2 style="color: #4caf50; font-size: 2rem; margin-bottom: 20px;">ğŸ‰ å…¨éƒ¨ç­”å°ï¼</h2>
                    <button onclick="resetGame()" style="padding: 10px 30px; font-size: 1.2rem; background-color: #2c3e50; color: white; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 4px 6px rgba(0,0,0,0.2);">
                        å†ç©ä¸€æ¬¡
                    </button>
                </div>
            </div>
        </div>

    </section>

    <section>
        <h2>å…§åˆ†æ³Œè…ºèˆ‡å¤–åˆ†æ³Œè…º</h2>
        <p>
            ç”Ÿç‰©é«”ä¸­åˆ†æ³Œç‰©è³ªçš„æ§‹é€ ç¨±ç‚ºè…ºé«”ï¼Œå¯åˆ†ç‚º<span class="kw-1">å…§åˆ†æ³Œè…º</span>å’Œ<span class="kw-2">å¤–åˆ†æ³Œè…º</span>ã€‚å…§åˆ†æ³Œè…ºæ‰€åˆ†æ³Œçš„ç‰©è³ªä¸»è¦ç”±<span class="kw-2">è¡€æ¶²</span>é‹è¼¸ï¼›è€Œ<span class="kw-2">å¤–åˆ†æ³Œè…º</span>å¤šå…·æœ‰ç‰¹å®šçš„é‹è¼¸<span class="kw-1">å°ç®¡</span>ï¼Œä¾‹å¦‚æ±—è…ºåŠæ¶ˆåŒ–è…ºå¯ä»¥å°‡æ±—æ¶²å’Œæ¶ˆåŒ–æ¶²ç­‰åˆ†æ³Œç‰©é‹é€åˆ°é«”å¤–æˆ–æ˜¯æ¶ˆåŒ–ç®¡ä¸­ã€‚
        </p>
        <div class="img-container">
            <img src="2_2.png" alt="å…§åˆ†æ³Œèˆ‡å¤–åˆ†æ³Œæ¯”è¼ƒåœ– - ä½”æ©«å¹…2/3">
        </div>
    </section>

    <div class="quiz-section">
        <h2>éš¨å ‚äº’å‹•ç·´ç¿’</h2>
        <p>è«‹å®Œæˆä¸‹æ–¹ä¸‰é¡Œä¸åŒé¡å‹çš„ç·´ç¿’ï¼Œå…¨å°å¾Œå³å¯è§£é–ä¸‹ä¸€é ã€‚</p>

        <div class="quiz-card" id="q1-card">
            <h3>Q1. å–®é¸é¡Œï¼šé—œæ–¼å…§åˆ†æ³Œè…ºèˆ‡å¤–åˆ†æ³Œè…ºçš„å€åˆ¥ï¼Œä¸‹åˆ—æ•˜è¿°ä½•è€…æ­£ç¢ºï¼Ÿ</h3>
            <div class="options">
                <label><input type="radio" name="q1" value="A" onchange="enableCheck('q1')"> A. å¤–åˆ†æ³Œè…ºçš„åˆ†æ³Œç‰©ç¶“ç”±è¡€æ¶²é‹è¼¸</label>
                <label><input type="radio" name="q1" value="B" onchange="enableCheck('q1')"> B. å…§åˆ†æ³Œè…ºå…·æœ‰å°ç®¡ï¼Œå¤–åˆ†æ³Œè…ºæ²’æœ‰å°ç®¡</label>
                <label><input type="radio" name="q1" value="C" onchange="enableCheck('q1')"> C. å…§åˆ†æ³Œè…ºåˆ†æ³Œæ¿€ç´ é€²å…¥è¡€æ¶²ï¼Œå¤–åˆ†æ³Œè…ºåˆ†æ³Œç‰©ç¶“å°ç®¡æ’å‡º</label>
                <label><input type="radio" name="q1" value="D" onchange="enableCheck('q1')"> D. æ±—è…ºå±¬æ–¼å…§åˆ†æ³Œè…ºï¼Œç”²ç‹€è…ºå±¬æ–¼å¤–åˆ†æ³Œè…º</label>
            </div>
            <button class="btn btn-check" id="btn-check-q1" onclick="checkQ1()" disabled>æª¢æŸ¥ç­”æ¡ˆ</button>
            <button class="btn btn-retry" id="btn-retry-q1" onclick="retryQ1()">é‡åšæœ¬é¡Œ</button>
            <div class="feedback" id="feedback-q1"></div>
        </div>

        <div class="quiz-card" id="q2-card">
            <h3>Q2. å¡«å……é¸å–®ï¼šé—œæ–¼æ¿€ç´ ç‰¹æ€§çš„èªªæ˜</h3>
            <p>
                æ¿€ç´ å°ç”Ÿç†åŠŸèƒ½çš„å½±éŸ¿åŠ›å¾ˆå¤§ï¼Œè¡€æ¶²ä¸­åªéœ€è¦ 
                <select id="q2-select" onchange="enableCheck('q2')">
                    <option value="" disabled selected>--è«‹é¸æ“‡--</option>
                    <option value="A">å¤§é‡çš„</option>
                    <option value="B">é©é‡çš„</option>
                    <option value="C">å¾®é‡çš„ï¼ˆç„¡ä½œç”¨ï¼‰</option>
                </select> 
                æ¿€ç´ å°±èƒ½ç”¢ç”Ÿä½œç”¨ã€‚è‹¥åˆ†æ³Œéå¤šæˆ–éå°‘ï¼Œéƒ½æœƒå°å€‹é«”ç”¢ç”Ÿä¸åˆ©çš„å½±éŸ¿ã€‚
            </p>
            <button class="btn btn-check" id="btn-check-q2" onclick="checkQ2()" disabled>æª¢æŸ¥ç­”æ¡ˆ</button>
            <button class="btn btn-retry" id="btn-retry-q2" onclick="retryQ2()">é‡åšæœ¬é¡Œ</button>
            <div class="feedback" id="feedback-q2"></div>
        </div>

        <div class="quiz-card" id="q3-card">
            <h3>Q3. æ‹–æ›³é…å°é¡Œï¼šè«‹å°‡ä¸‹æ–¹çš„è…ºé«”æ¨™ç±¤ï¼Œæ‹–æ›³è‡³æ­£ç¢ºçš„åˆ†é¡æ¡†ä¸­ã€‚</h3>
            <p style="font-size: 0.9em; color: #666;">ï¼ˆè«‹å°‡ç°è‰²å€åŸŸçš„æ¨™ç±¤å…¨éƒ¨åˆ†é¡å®Œç•¢å¾Œï¼Œé»é¸æª¢æŸ¥ç­”æ¡ˆï¼‰</p>
            
            <div class="drag-area">
                <div class="source-box" id="source-pool" ondrop="drop(event)" ondragover="allowDrop(event)">
                    </div>
                <div class="drop-zones-container">
                    <div class="drop-zone" id="zone-endo" ondrop="drop(event)" ondragover="allowDrop(event)"><h4>å…§åˆ†æ³Œè…º</h4></div>
                    <div class="drop-zone" id="zone-exo" ondrop="drop(event)" ondragover="allowDrop(event)"><h4>å¤–åˆ†æ³Œè…º</h4></div>
                </div>
            </div>
            <button class="btn btn-check" id="btn-check-q3" onclick="checkQ3()" disabled>æª¢æŸ¥ç­”æ¡ˆ</button>
            <button class="btn btn-retry" id="btn-retry-q3" onclick="retryQ3()">é‡åšæœ¬é¡Œ</button>
            <div class="feedback" id="feedback-q3"></div>
        </div>
    </div>

    <nav class="nav-bar">
        <a href="1.html" class="nav-link">â† ä¸Šä¸€é </a>
        <a href="./3.html" class="nav-link disabled" id="next-btn">ä¸‹ä¸€é  â†’</a>
    </nav>
</div>

<script>
    // ============================================
    // PART 0: å…¨å±€ç‹€æ…‹è¿½è¹¤
    // ============================================
    let state = { 
        q1: false, 
        q2: false, 
        q3: false,
        testGame: false // æ–°å¢ï¼šæ‹–æ›³éŠæˆ²ä¹Ÿå¿…é ˆéé—œ
    };

    function checkCompletion() {
        const nextBtn = document.getElementById('next-btn');
        // æª¢æŸ¥ 4 å€‹æ¢ä»¶æ˜¯å¦éƒ½é”æˆ
        if (state.q1 && state.q2 && state.q3 && state.testGame) {
            nextBtn.classList.remove('disabled');
        } else {
            nextBtn.classList.add('disabled');
        }
    }


    // ============================================
    // PART 1: äº’å‹•äººé«”åœ–é‚è¼¯
    // ============================================
    const glandsData = {
        1: { title: "1. è…¦å‚è…º", desc: "åˆ†æ³Œ<b>ç”Ÿé•·æ¿€ç´ </b>ï¼Œç‚ºå…§åˆ†æ³Œç³»çµ±çš„ç¸½æŒ‡æ®ã€‚" },
        2: { title: "2. ç”²ç‹€è…º", desc: "åˆ†æ³Œ<b>ç”²ç‹€è…ºç´ </b>ï¼Œæ§åˆ¶ç´°èƒä»£è¬åŠç”Ÿé•·ã€‚" },
        3: { title: "3. å‰¯ç”²ç‹€è…º", desc: "åˆ†æ³Œ<b>å‰¯ç”²ç‹€è…ºç´ </b>ï¼Œèª¿ç¯€è¡€æ¶²ä¸­éˆ£çš„æ¿ƒåº¦ã€‚" },
        4: { title: "4. è…ä¸Šè…º", desc: "åˆ†æ³Œ<b>è…ä¸Šè…ºç´ </b>ï¼Œä»¥æ‡‰ä»˜ç·Šæ€¥ç‹€æ³ã€‚" },
        5: { title: "5. èƒ°å³¶", desc: "åˆ†æ³Œ<b>èƒ°å³¶ç´ </b>åŠ<b>å‡ç³–ç´ </b>ï¼Œèª¿ç¯€è¡€ç³–æ¿ƒåº¦ã€‚" },
        6: { title: "6. æ€§è…º (åµå·¢/çªä¸¸)", desc: "<b>åµå·¢ï¼š</b>åˆ†æ³Œé›Œæ€§æ¿€ç´ ï¼Œè¡¨ç¾å¥³æ€§ç¬¬äºŒæ€§å¾µã€‚<br><b>çªä¸¸ï¼š</b>åˆ†æ³Œé›„æ€§æ¿€ç´ ï¼Œè¡¨ç¾ç”·æ€§ç¬¬äºŒæ€§å¾µã€‚" }
    };

    function initInteractiveMap() {
        const hotspots = document.querySelectorAll('.hotspot');
        const tooltip = document.getElementById('tooltip');

        hotspots.forEach(spot => {
            spot.addEventListener('mouseenter', (e) => {
                const id = spot.getAttribute('data-id');
                showTooltip(id, e, tooltip);
            });
            spot.addEventListener('click', (e) => {
                const id = spot.getAttribute('data-id');
                showTooltip(id, e, tooltip);
            });
            spot.addEventListener('mousemove', (e) => {
                moveTooltip(e, tooltip);
            });
            spot.addEventListener('mouseleave', () => {
                tooltip.style.display = 'none';
            });
        });
    }

    function showTooltip(id, e, tooltip) {
        const data = glandsData[id];
        if (data) {
            tooltip.innerHTML = `<h3>${data.title}</h3><p>${data.desc}</p>`;
            tooltip.style.display = 'block';
            moveTooltip(e, tooltip);
        }
    }

    function moveTooltip(e, tooltip) {
        let x = e.pageX + 20; 
        let y = e.pageY + 20;
        const tooltipWidth = 280;
        if (x + tooltipWidth > window.innerWidth) {
            x = e.pageX - tooltipWidth - 20;
        }
        tooltip.style.left = x + 'px';
        tooltip.style.top = y + 'px';
    }


    // ============================================
    // PART 2: æ¸¬é©—éŠæˆ²é‚è¼¯
    // ============================================
    let testCorrectCount = 0;
    const testTotalItems = 12;
    let currentTestDragItem = null;

    function initTestGame() {
        const container = document.getElementById('test-options-container');
        const items = Array.from(container.querySelectorAll('.test-draggable-item'));
        items.sort(() => Math.random() - 0.5); 
        items.forEach(item => container.appendChild(item));

        const draggables = document.querySelectorAll('.test-draggable-item');
        const dropZones = document.querySelectorAll('.test-drop-zone');
        
        draggables.forEach(item => {
            item.setAttribute('draggable', true);
            item.addEventListener('dragstart', (e) => {
                currentTestDragItem = item;
                item.classList.add('dragging');
                e.dataTransfer.effectAllowed = 'move';
                e.dataTransfer.setData('text/plain', JSON.stringify({ id: item.dataset.id, type: item.dataset.type }));
            });
            item.addEventListener('dragend', () => {
                item.classList.remove('dragging');
                currentTestDragItem = null;
            });

            // Touch Support
            item.addEventListener('touchstart', (e) => {
                if(e.touches.length === 1) {
                    currentTestDragItem = item;
                    item.classList.add('touch-drag');
                    const touch = e.touches[0];
                    moveElementToTouch(item, touch);
                }
            }, {passive: false});
            item.addEventListener('touchmove', (e) => {
                if(currentTestDragItem) {
                    e.preventDefault();
                    const touch = e.touches[0];
                    moveElementToTouch(item, touch);
                    highlightZoneUnderTouch(touch.clientX, touch.clientY);
                }
            }, {passive: false});
            item.addEventListener('touchend', (e) => {
                if(currentTestDragItem) {
                    item.classList.remove('touch-drag');
                    item.style.position = ''; item.style.left = ''; item.style.top = ''; item.style.width = ''; item.style.transform = '';
                    const touch = e.changedTouches[0];
                    checkTestDrop(touch.clientX, touch.clientY);
                    currentTestDragItem = null;
                    dropZones.forEach(z => z.classList.remove('drag-over'));
                }
            });
        });

        dropZones.forEach(zone => {
            zone.addEventListener('dragover', (e) => {
                e.preventDefault(); 
                if (!zone.classList.contains('correct')) zone.classList.add('drag-over');
            });
            zone.addEventListener('dragleave', () => zone.classList.remove('drag-over'));
            zone.addEventListener('drop', (e) => {
                e.preventDefault();
                zone.classList.remove('drag-over');
                if (currentTestDragItem && !zone.classList.contains('correct')) validateMatch(zone, currentTestDragItem);
            });
        });
    }

    function moveElementToTouch(elem, touch) {
        elem.style.left = (touch.clientX - elem.offsetWidth / 2) + 'px';
        elem.style.top = (touch.clientY - elem.offsetHeight / 2) + 'px';
    }

    function highlightZoneUnderTouch(x, y) {
        const dropZones = document.querySelectorAll('.test-drop-zone');
        dropZones.forEach(zone => zone.classList.remove('drag-over'));
        if(currentTestDragItem) currentTestDragItem.style.display = 'none';
        const elemBelow = document.elementFromPoint(x, y);
        if(currentTestDragItem) currentTestDragItem.style.display = '';
        if (!elemBelow) return;
        const droppableBelow = elemBelow.closest('.test-drop-zone');
        if (droppableBelow && !droppableBelow.classList.contains('correct')) {
            droppableBelow.classList.add('drag-over');
        }
    }

    function checkTestDrop(x, y) {
        if(!currentTestDragItem) return;
        currentTestDragItem.style.display = 'none';
        const elemBelow = document.elementFromPoint(x, y);
        currentTestDragItem.style.display = '';
        if (!elemBelow) return;
        const zone = elemBelow.closest('.test-drop-zone');
        if (zone && !zone.classList.contains('correct')) {
            validateMatch(zone, currentTestDragItem);
        }
    }

    function validateMatch(zone, item) {
        const dragId = item.dataset.id;
        const dragType = item.dataset.type;
        const zoneId = zone.dataset.id;
        const zoneType = zone.dataset.type;

        if (dragId === zoneId && dragType === zoneType) {
            zone.innerText = item.innerText;
            zone.classList.add('correct');
            item.classList.add('matched');
            item.removeAttribute('draggable');
            testCorrectCount++;
            
            // ç•¶éŠæˆ²å…¨éƒ¨ç­”å°æ™‚
            if (testCorrectCount === testTotalItems) {
                setTimeout(() => document.getElementById('test-success-overlay').style.display = 'flex', 300);
                state.testGame = true; // æ¨™è¨˜éŠæˆ²éé—œ
                checkCompletion();     // æª¢æŸ¥æ˜¯å¦å¯ä»¥è§£é–
            }
        }
    }

    function resetGame() {
        location.reload(); 
    }


    // ============================================
    // PART 3: åŸæœ¬ 2.html çš„ Q1-Q3 é‚è¼¯
    // ============================================
    
    function enableCheck(qId) { document.getElementById(`btn-check-${qId}`).disabled = false; }

    function checkQ1() {
        const selected = document.querySelector('input[name="q1"]:checked');
        const card = document.getElementById('q1-card');
        const feedback = document.getElementById('feedback-q1');
        const checkBtn = document.getElementById('btn-check-q1');
        const inputs = document.querySelectorAll('input[name="q1"]');
        if (!selected) return;
        inputs.forEach(input => input.disabled = true);
        checkBtn.style.display = 'none';
        if (selected.value === 'C') {
            card.classList.add('correct'); card.classList.remove('incorrect');
            feedback.innerHTML = "æ­£ç¢ºï¼å…§åˆ†æ³Œè…ºç„¡å°ç®¡ï¼ˆç¶“è¡€æ¶²ï¼‰ï¼Œå¤–åˆ†æ³Œè…ºæœ‰å°ç®¡ã€‚";
            state.q1 = true; checkCompletion();
        } else {
            card.classList.add('incorrect'); card.classList.remove('correct');
            feedback.innerHTML = "éŒ¯èª¤ã€‚æç¤ºï¼šå…§åˆ†æ³Œè…ºæ˜¯ç¶“ç”±ã€Œè¡€æ¶²ã€é‹è¼¸ï¼Œä¸”æ²’æœ‰å°ç®¡ï¼›å¤–åˆ†æ³Œè…ºæ‰æœ‰å°ç®¡ã€‚";
            state.q1 = false; document.getElementById('btn-retry-q1').style.display = 'inline-block';
        }
    }
    function retryQ1() {
        resetGeneric('q1');
        document.querySelectorAll('input[name="q1"]').forEach(i => { i.checked = false; i.disabled = false; });
    }

    function checkQ2() {
        const select = document.getElementById('q2-select');
        const card = document.getElementById('q2-card');
        const feedback = document.getElementById('feedback-q2');
        const checkBtn = document.getElementById('btn-check-q2');
        if (select.value === "") return;
        select.disabled = true; checkBtn.style.display = 'none';
        if (select.value === 'B') {
            card.classList.add('correct'); card.classList.remove('incorrect');
            feedback.innerHTML = "æ­£ç¢ºï¼æ¿€ç´ åªéœ€è¦ã€Œé©é‡ã€å³å¯ç”¢ç”Ÿæ˜é¡¯ä½œç”¨ã€‚";
            state.q2 = true; checkCompletion();
        } else {
            card.classList.add('incorrect'); card.classList.remove('correct');
            feedback.innerHTML = "éŒ¯èª¤ã€‚æç¤ºï¼šæ–‡ä¸­æåˆ°ã€Œè¡€æ¶²ä¸­åªéœ€è¦é©é‡æ¿€ç´ ã€ã€‚";
            state.q2 = false; document.getElementById('btn-retry-q2').style.display = 'inline-block';
        }
    }
    function retryQ2() {
        resetGeneric('q2');
        const select = document.getElementById('q2-select'); select.value = ""; select.disabled = false;
    }

    // Q3 Data
    const q3ItemsData = [
        { id: 'i1', name: 'ç”²ç‹€è…º', type: 'endo' }, { id: 'i2', name: 'èƒ°å³¶', type: 'endo' },
        { id: 'i3', name: 'è…¦å‚è…º', type: 'endo' }, { id: 'i4', name: 'è…ä¸Šè…º', type: 'endo' },
        { id: 'i5', name: 'æ€§è…º', type: 'endo' }, { id: 'i6', name: 'å‰¯ç”²ç‹€è…º', type: 'endo' },
        { id: 'i7', name: 'æ±—è…º', type: 'exo' }, { id: 'i8', name: 'å”¾è…º', type: 'exo' }, { id: 'i9', name: 'çš®è„‚è…º', type: 'exo' }
    ];

    function initQ3() {
        const sourcePool = document.getElementById('source-pool');
        sourcePool.innerHTML = '';
        document.getElementById('zone-endo').innerHTML = '<h4>å…§åˆ†æ³Œè…º</h4>';
        document.getElementById('zone-exo').innerHTML = '<h4>å¤–åˆ†æ³Œè…º</h4>';
        const shuffled = [...q3ItemsData].sort(() => 0.5 - Math.random());
        shuffled.forEach(item => {
            const el = document.createElement('div');
            el.className = 'draggable-item';
            el.draggable = true;
            el.id = item.id;
            el.innerText = item.name;
            el.dataset.type = item.type;
            el.ondragstart = drag;
            sourcePool.appendChild(el);
        });
        updateQ3CheckButton();
    }

    function allowDrop(ev) { ev.preventDefault(); ev.currentTarget.classList.add('over'); }
    function drag(ev) { ev.dataTransfer.setData("text", ev.target.id); }
    function drop(ev) {
        ev.preventDefault();
        var data = ev.dataTransfer.getData("text");
        var draggedElement = document.getElementById(data);
        if(!draggedElement) return; // Basic check
        var target = ev.target;
        if (target.classList.contains('draggable-item') || target.tagName === 'H4') target = target.parentElement;
        if (target.classList.contains('drop-zone') || target.classList.contains('source-box')) {
            target.appendChild(draggedElement);
            updateQ3CheckButton();
        }
        document.querySelectorAll('.drop-zone, .source-box').forEach(el => el.classList.remove('over'));
    }

    document.addEventListener('dragend', () => {
        document.querySelectorAll('.drop-zone, .source-box').forEach(el => el.classList.remove('over'));
    });
    document.querySelectorAll('.drop-zone, .source-box').forEach(el => {
        el.addEventListener('dragleave', (ev) => ev.currentTarget.classList.remove('over'));
    });

    function updateQ3CheckButton() {
        const sourcePool = document.getElementById('source-pool');
        const btn = document.getElementById('btn-check-q3');
        if (sourcePool.children.length === 0) btn.disabled = false; else btn.disabled = true;
    }

    function checkQ3() {
        const endoZone = document.getElementById('zone-endo');
        const exoZone = document.getElementById('zone-exo');
        const card = document.getElementById('q3-card');
        const feedback = document.getElementById('feedback-q3');
        const checkBtn = document.getElementById('btn-check-q3');
        let correct = true;
        Array.from(endoZone.children).forEach(child => {
            if (child.classList.contains('draggable-item')) { if (child.dataset.type !== 'endo') correct = false; child.draggable = false; }
        });
        Array.from(exoZone.children).forEach(child => {
            if (child.classList.contains('draggable-item')) { if (child.dataset.type !== 'exo') correct = false; child.draggable = false; }
        });
        checkBtn.style.display = 'none';
        if (correct) {
            card.classList.add('correct'); card.classList.remove('incorrect');
            feedback.innerHTML = "å®Œå…¨æ­£ç¢ºï¼æ‚¨å·²æˆåŠŸåˆ†é¡æ‰€æœ‰è…ºé«”ã€‚";
            state.q3 = true; checkCompletion();
        } else {
            card.classList.add('incorrect'); card.classList.remove('correct');
            feedback.innerHTML = "åˆ†é¡æœ‰èª¤ã€‚è«‹è¨˜å¾—ï¼šæ±—è…ºã€å”¾è…ºã€çš®è„‚è…ºç­‰æœ‰å°ç®¡çš„æ˜¯ã€Œå¤–åˆ†æ³Œè…ºã€ï¼Œå…¶ä»–é€²å…¥è¡€æ¶²çš„æ˜¯ã€Œå…§åˆ†æ³Œè…ºã€ã€‚";
            state.q3 = false; document.getElementById('btn-retry-q3').style.display = 'inline-block';
        }
    }
    function retryQ3() { resetGeneric('q3'); initQ3(); }
    function resetGeneric(qId) {
        const card = document.getElementById(`${qId}-card`);
        const feedback = document.getElementById(`feedback-${qId}`);
        const checkBtn = document.getElementById(`btn-check-${qId}`);
        const retryBtn = document.getElementById(`btn-retry-${qId}`);
        card.classList.remove('correct', 'incorrect');
        feedback.style.display = 'none'; retryBtn.style.display = 'none';
        checkBtn.style.display = 'inline-block'; checkBtn.disabled = true;
        state[qId] = false; checkCompletion();
    }


    // ============================================
    // Initialization
    // ============================================
    window.onload = function() {
        initInteractiveMap(); 
        initTestGame();       
        initQ3();             
    };
</script>

</body>
</html>